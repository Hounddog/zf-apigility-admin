<ng-include src="'zf-apigility-admin/partials/api/version.html'"></ng-include>

<ag-include src="zf-apigility-admin/partials/api/rest-services/new.html"></ag-include>

<div class="panel-group tooltip-api">
    <collapse class="panel-info" 
        conditionals="{edit: false, delete: false}"
        ng-repeat="restService in api.restServices">
        <collapse-header>
            <h4 class="panel-title">
                <span class="btn btn-small glyphicon glyphicon-leaf"></span>

                {{ restService.entity_class }}

                <div class="btn-group pull-right">
                    <button
                        type="button" title="Cancel" class="btn btn-sm btn-default"
                        collapse-flag flags="{edit: false}" 
                        collapse-button criteria="{delete: false, edit: true}">
                        Cancel
                    </button>

                    <button 
                        type="button" class="btn btn-sm btn-success" title="Edit service"
                        collapse-flag flags="{edit: true}"
                        collapse-button criteria="{delete: false, edit: false}">
                        <span class="glyphicon glyphicon-edit"></span>
                    </button>

                    <button 
                        type="button" class="btn btn-sm btn-danger" title="Remove serivce"
                        collapse-flag flags="{delete: true}"
                        collapse-button criteria="{delete: false}">
                        <span class="glyphicon glyphicon-trash"></span>
                    </button>
                </div>
            </h4>

            <div class="clearfix"></div>

            <div collapse-show criteria="{delete: true}" class="panel panel-danger hide">
                <div class="panel-heading">Remove REST service</div>

                <div class="panel-body">
                    <p>Are you sure you want to delete the service?</p>

                    <div class="btn-group pull-right">
                        <button type="button" class="btn btn-sm btn-default"
                            collapse-flag flags="{delete: false}">
                            No
                        </button>
                        <button type="button" class="btn btn-sm btn-danger"
                            ng-click="removeRestService(restService.controller_service_name)">
                            Yes
                        </button>
                    </div>
                </div>
            </div>
        </collapse-header>

        <collapse-body>
            <ag-tabs collapse-show criteria="{edit: false}">
                <ag-tab-pane title="Settings">
                    <ng-include src="'zf-apigility-admin/partials/api/rest-services/settings-view.html'"></ng-include>
                </ag-tab-pane>

                <ag-tab-pane title="Fields">
                    <ng-include src="'zf-apigility-admin/partials/api/input-filter-view.html'"
                        onload="index = $index"></ng-include>
                </ag-tab-pane>

                <ag-tab-pane title="Source Code">
                    <ng-include 
                        src="'zf-apigility-admin/partials/api/rest-services/source-code.html'"
                        onload="index = $index; service = restService"></ng-include>
                </ag-tab-pane>
            </ag-tabs>

            <ag-tabs class="hide" collapse-show criteria="{edit: true}">
                <ag-tab-pane title="Settings">
                    <ng-include src="'zf-apigility-admin/partials/api/rest-services/settings-edit.html'"></ng-include>
                </ag-tab-pane>

                <ag-tab-pane title="Fields">
                    <ng-include src="'zf-apigility-admin/partials/api/input-filter-edit.html'"
                        onload="index = $index"></ng-include>
                </ag-tab-pane>
            </ag-tabs>
        </collapse-body>
    </collapse>
</div>

